__d((function(g,_r,i,_a,m,e,d){Object.defineProperty(e,'__esModule',{value:!0});var t=(function(){"use strict";function t(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_r(d[0])(this,t),this.name=t.id,this._router=r.router||r.app,this._methods=(Array.isArray(r.methods)?r.methods:[]).concat('use')}return _r(d[1])(t,[{key:"setupOnce",value:function(t,r){this._router?_r(d[3]).shouldDisableAutoInstrumentation(r)?('undefined'==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&_r(d[2]).logger.log('Express Integration is skipped because of instrumenter configuration.'):(a(this._router,this._methods),s(this._router)):('undefined'==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&_r(d[2]).logger.error('ExpressIntegration is missing an Express instance')}}],[{key:"__initStatic",value:function(){this.id='Express'}}]),t})();function r(t,r){var n=t.length;switch(n){case 2:return function(n,o){var a=o.__sentry_transaction;if(a){var s=a.startChild({description:t.name,op:`middleware.express.${r}`});o.once('finish',(function(){s.finish()}))}return t.call(this,n,o)};case 3:return function(n,o,a){var s=o.__sentry_transaction,u=_r(d[4])._optionalChain([s,'optionalAccess',function(t){return t.startChild},'call',function(n){return n({description:t.name,op:`middleware.express.${r}`})}]);t.call(this,n,o,(function(){_r(d[4])._optionalChain([u,'optionalAccess',function(t){return t.finish},'call',function(t){return t()}]);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];a.call.apply(a,[this].concat(r))}))};case 4:return function(n,o,a,s){var u=a.__sentry_transaction,c=_r(d[4])._optionalChain([u,'optionalAccess',function(t){return t.startChild},'call',function(n){return n({description:t.name,op:`middleware.express.${r}`})}]);t.call(this,n,o,a,(function(){_r(d[4])._optionalChain([c,'optionalAccess',function(t){return t.finish},'call',function(t){return t()}]);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];s.call.apply(s,[this].concat(r))}))};default:throw new Error(`Express middleware takes 2-4 arguments. Got: ${n}`)}}function n(t,n){return t.map((function(t){return'function'==typeof t?r(t,n):Array.isArray(t)?t.map((function(t){return'function'==typeof t?r(t,n):t})):t}))}function o(t,r){var o=t[r];return t[r]=function(){for(var t=arguments.length,a=new Array(t),s=0;s<t;s++)a[s]=arguments[s];return o.call.apply(o,[this].concat(_r(d[5])(n(a,r))))},t}function a(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];r.forEach((function(r){return o(t,r)}))}function s(t){var r='settings'in t;r&&void 0===t._router&&t.lazyrouter&&t.lazyrouter();var n=r?t._router:t;if(!n)return('undefined'==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&_r(d[2]).logger.debug('Cannot instrument router for URL Parameterization (did not find a valid router).'),void(('undefined'==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&_r(d[2]).logger.debug('Routing instrumentation is currently only supported in Express 4.'));var o=Object.getPrototypeOf(n),a=o.process_params;o.process_params=function(t,r,n,o,s){n._reconstructedRoute||(n._reconstructedRoute='');var c=u(t),l=c.layerRoutePath,_=c.isRegex,f=c.isArray,p=c.numExtraSegments;(l||_||f)&&(n._hasParameters=!0);var h=(l||t.path||'').split('/').filter((function(t){return t.length>0&&(_||f||!t.includes('*'))})).join('/');if(h&&h.length>0&&(n._reconstructedRoute+=`/${h}${_?'/':''}`),_r(d[2]).getNumberOfUrlSegments(n.originalUrl||'')+p===_r(d[2]).getNumberOfUrlSegments(n._reconstructedRoute)){n._hasParameters||n._reconstructedRoute!==n.originalUrl&&(n._reconstructedRoute=n.originalUrl?_r(d[2]).stripUrlQueryAndFragment(n.originalUrl):n.originalUrl);var y=o.__sentry_transaction;if(y&&'custom'!==y.metadata.source){var v=n._reconstructedRoute||'/';y.setName.apply(y,_r(d[5])(_r(d[2]).extractPathForTransaction(n,{path:!0,method:!0,customRoute:v})))}}return a.call(this,t,r,n,o,s)}}function u(t){var r=_r(d[4])._optionalChain([t,'access',function(t){return t.route},'optionalAccess',function(t){return t.path}]),n=_r(d[2]).isRegExp(r),o=Array.isArray(r);if(!r)return{isRegex:n,isArray:o,numExtraSegments:0};var a=o?Math.max(r.reduce((function(t,r){return t+_r(d[2]).getNumberOfUrlSegments(r.toString())}),0)-_r(d[2]).getNumberOfUrlSegments(t.path||''),0):0;return{layerRoutePath:c(o,r),isRegex:n,isArray:o,numExtraSegments:a}}function c(t,r){return t?r.map((function(t){return t.toString()})).join(','):r&&r.toString()}t.__initStatic(),e.Express=t}),537,[451,452,426,538,539,429]);