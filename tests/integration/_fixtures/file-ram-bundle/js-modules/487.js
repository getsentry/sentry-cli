__d((function(g,r,i,a,m,e,d){Object.defineProperty(e,'__esModule',{value:!0});var t=(function(){"use strict";function t(){r(d[0])(this,t),this._notifyingListeners=!1,this._scopeListeners=[],this._eventProcessors=[],this._breadcrumbs=[],this._attachments=[],this._user={},this._tags={},this._extra={},this._contexts={},this._sdkProcessingMetadata={},this._propagationContext=n()}return r(d[1])(t,[{key:"addScopeListener",value:function(t){this._scopeListeners.push(t)}},{key:"addEventProcessor",value:function(t){return this._eventProcessors.push(t),this}},{key:"setUser",value:function(t){return this._user=t||{},this._session&&r(d[2]).updateSession(this._session,{user:t}),this._notifyScopeListeners(),this}},{key:"getUser",value:function(){return this._user}},{key:"getRequestSession",value:function(){return this._requestSession}},{key:"setRequestSession",value:function(t){return this._requestSession=t,this}},{key:"setTags",value:function(t){return this._tags=Object.assign({},this._tags,t),this._notifyScopeListeners(),this}},{key:"setTag",value:function(t,s){return this._tags=Object.assign({},this._tags,r(d[3])({},t,s)),this._notifyScopeListeners(),this}},{key:"setExtras",value:function(t){return this._extra=Object.assign({},this._extra,t),this._notifyScopeListeners(),this}},{key:"setExtra",value:function(t,s){return this._extra=Object.assign({},this._extra,r(d[3])({},t,s)),this._notifyScopeListeners(),this}},{key:"setFingerprint",value:function(t){return this._fingerprint=t,this._notifyScopeListeners(),this}},{key:"setLevel",value:function(t){return this._level=t,this._notifyScopeListeners(),this}},{key:"setTransactionName",value:function(t){return this._transactionName=t,this._notifyScopeListeners(),this}},{key:"setContext",value:function(t,s){return null===s?delete this._contexts[t]:this._contexts[t]=s,this._notifyScopeListeners(),this}},{key:"setSpan",value:function(t){return this._span=t,this._notifyScopeListeners(),this}},{key:"getSpan",value:function(){return this._span}},{key:"getTransaction",value:function(){var t=this.getSpan();return t&&t.transaction}},{key:"setSession",value:function(t){return t?this._session=t:delete this._session,this._notifyScopeListeners(),this}},{key:"getSession",value:function(){return this._session}},{key:"update",value:function(s){if(!s)return this;if('function'==typeof s){var n=s(this);return n instanceof t?n:this}return s instanceof t?(this._tags=Object.assign({},this._tags,s._tags),this._extra=Object.assign({},this._extra,s._extra),this._contexts=Object.assign({},this._contexts,s._contexts),s._user&&Object.keys(s._user).length&&(this._user=s._user),s._level&&(this._level=s._level),s._fingerprint&&(this._fingerprint=s._fingerprint),s._requestSession&&(this._requestSession=s._requestSession),s._propagationContext&&(this._propagationContext=s._propagationContext)):r(d[4]).isPlainObject(s)&&(this._tags=Object.assign({},this._tags,s.tags),this._extra=Object.assign({},this._extra,s.extra),this._contexts=Object.assign({},this._contexts,s.contexts),s.user&&(this._user=s.user),s.level&&(this._level=s.level),s.fingerprint&&(this._fingerprint=s.fingerprint),s.requestSession&&(this._requestSession=s.requestSession),s.propagationContext&&(this._propagationContext=s.propagationContext)),this}},{key:"clear",value:function(){return this._breadcrumbs=[],this._tags={},this._extra={},this._user={},this._contexts={},this._level=void 0,this._transactionName=void 0,this._fingerprint=void 0,this._requestSession=void 0,this._span=void 0,this._session=void 0,this._notifyScopeListeners(),this._attachments=[],this._propagationContext=n(),this}},{key:"addBreadcrumb",value:function(t,s){var n='number'==typeof s?s:100;if(n<=0)return this;var o=Object.assign({timestamp:r(d[4]).dateTimestampInSeconds()},t);return this._breadcrumbs=[].concat(r(d[5])(this._breadcrumbs),[o]).slice(-n),this._notifyScopeListeners(),this}},{key:"getLastBreadcrumb",value:function(){return this._breadcrumbs[this._breadcrumbs.length-1]}},{key:"clearBreadcrumbs",value:function(){return this._breadcrumbs=[],this._notifyScopeListeners(),this}},{key:"addAttachment",value:function(t){return this._attachments.push(t),this}},{key:"getAttachments",value:function(){return this._attachments}},{key:"clearAttachments",value:function(){return this._attachments=[],this}},{key:"applyToEvent",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._extra&&Object.keys(this._extra).length&&(t.extra=Object.assign({},this._extra,t.extra)),this._tags&&Object.keys(this._tags).length&&(t.tags=Object.assign({},this._tags,t.tags)),this._user&&Object.keys(this._user).length&&(t.user=Object.assign({},this._user,t.user)),this._contexts&&Object.keys(this._contexts).length&&(t.contexts=Object.assign({},this._contexts,t.contexts)),this._level&&(t.level=this._level),this._transactionName&&(t.transaction=this._transactionName),this._span){t.contexts=Object.assign({trace:this._span.getTraceContext()},t.contexts);var o=this._span.transaction;if(o){t.sdkProcessingMetadata=Object.assign({dynamicSamplingContext:o.getDynamicSamplingContext()},t.sdkProcessingMetadata);var c=o.name;c&&(t.tags=Object.assign({transaction:c},t.tags))}}return this._applyFingerprint(t),t.breadcrumbs=[].concat(r(d[5])(t.breadcrumbs||[]),r(d[5])(this._breadcrumbs)),t.breadcrumbs=t.breadcrumbs.length>0?t.breadcrumbs:void 0,t.sdkProcessingMetadata=Object.assign({},t.sdkProcessingMetadata,this._sdkProcessingMetadata,{propagationContext:this._propagationContext}),this._notifyEventProcessors([].concat(r(d[5])(s()),r(d[5])(this._eventProcessors)),t,n)}},{key:"setSDKProcessingMetadata",value:function(t){return this._sdkProcessingMetadata=Object.assign({},this._sdkProcessingMetadata,t),this}},{key:"setPropagationContext",value:function(t){return this._propagationContext=t,this}},{key:"getPropagationContext",value:function(){return this._propagationContext}},{key:"_notifyEventProcessors",value:function(t,s,n){var o=this,c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return new(r(d[4]).SyncPromise)((function(u,_){var h=t[c];if(null===s||'function'!=typeof h)u(s);else{var l=h(Object.assign({},s),n);('undefined'==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&h.id&&null===l&&r(d[4]).logger.log(`Event processor "${h.id}" dropped event`),r(d[4]).isThenable(l)?l.then((function(s){return o._notifyEventProcessors(t,s,n,c+1).then(u)})).then(null,_):o._notifyEventProcessors(t,l,n,c+1).then(u).then(null,_)}}))}},{key:"_notifyScopeListeners",value:function(){var t=this;this._notifyingListeners||(this._notifyingListeners=!0,this._scopeListeners.forEach((function(s){s(t)})),this._notifyingListeners=!1)}},{key:"_applyFingerprint",value:function(t){t.fingerprint=t.fingerprint?r(d[4]).arrayify(t.fingerprint):[],this._fingerprint&&(t.fingerprint=t.fingerprint.concat(this._fingerprint)),t.fingerprint&&!t.fingerprint.length&&delete t.fingerprint}}],[{key:"clone",value:function(s){var n=new t;return s&&(n._breadcrumbs=r(d[5])(s._breadcrumbs),n._tags=Object.assign({},s._tags),n._extra=Object.assign({},s._extra),n._contexts=Object.assign({},s._contexts),n._user=s._user,n._level=s._level,n._span=s._span,n._session=s._session,n._transactionName=s._transactionName,n._fingerprint=s._fingerprint,n._eventProcessors=r(d[5])(s._eventProcessors),n._requestSession=s._requestSession,n._attachments=r(d[5])(s._attachments),n._sdkProcessingMetadata=Object.assign({},s._sdkProcessingMetadata),n._propagationContext=Object.assign({},s._propagationContext)),n}}]),t})();function s(){return r(d[4]).getGlobalSingleton('globalEventProcessors',(function(){return[]}))}function n(){return{traceId:r(d[4]).uuid4(),spanId:r(d[4]).uuid4().substring(16),sampled:!1}}e.Scope=t,e.addGlobalEventProcessor=function(t){s().push(t)}}),487,[451,452,488,489,426,429]);