__d((function(g,r,i,a,m,e,d){Object.defineProperty(e,"__esModule",{value:!0}),e.ReactNativeTracing=void 0;var t=r(d[0])(r(d[1])),n=r(d[0])(r(d[2])),o=Object.assign(Object.assign({},r(d[3]).defaultRequestInstrumentationOptions),{idleTimeout:1e3,maxTransactionDuration:600,idleTimeoutMs:1e3,finalTimeoutMs:6e5,ignoreEmptyBackNavigationTransactions:!0,beforeNavigate:function(t){return t},enableAppStartTracking:!0,enableNativeFramesTracking:!0,enableStallTracking:!0,enableUserInteractionTracing:!1}),s=(function(){function s(){var n,c,l,u,p=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,t.default)(this,s),this.name=s.id,this.useAppStartWithProfiler=!1,this.options=Object.assign(Object.assign(Object.assign({},o),p),{finalTimeoutMs:null!==(c=null!==(n=p.finalTimeoutMs)&&void 0!==n?n:'number'==typeof p.maxTransactionDuration?1e3*p.maxTransactionDuration:void 0)&&void 0!==c?c:o.finalTimeoutMs,idleTimeoutMs:null!==(u=null!==(l=p.idleTimeoutMs)&&void 0!==l?l:p.idleTimeout)&&void 0!==u?u:o.idleTimeoutMs})}return(0,n.default)(s,[{key:"setupOnce",value:function(t,n){var o=n().getClient(),c=o&&o.getOptions(),l=this.options,u=l.traceFetch,p=l.traceXHR,T=l.tracingOrigins,h=l.shouldCreateSpanForRequest,v=l.tracePropagationTargets,f=l.routingInstrumentation,_=l.enableAppStartTracking,S=l.enableNativeFramesTracking,I=l.enableStallTracking;this._getCurrentHub=n;var b=c&&c.tracePropagationTargets||v;_&&this._instrumentAppStart(),S?(r(d[4]).NATIVE.enableNativeFramesTracking(),this.nativeFramesInstrumentation=new(r(d[5]).NativeFramesInstrumentation)(t,(function(){var t=n().getIntegration(s);return!!t&&!!t.nativeFramesInstrumentation}))):r(d[4]).NATIVE.disableNativeFramesTracking(),I&&(this.stallTrackingInstrumentation=new(r(d[6]).StallTrackingInstrumentation)),f?f.registerRoutingInstrumentation(this._onRouteWillChange.bind(this),this.options.beforeNavigate,this._onConfirmRoute.bind(this)):r(d[7]).logger.log('[ReactNativeTracing] Not instrumenting route changes as routingInstrumentation has not been set.'),(0,r(d[3]).instrumentOutgoingRequests)({traceFetch:u,traceXHR:p,tracingOrigins:T,shouldCreateSpanForRequest:h,tracePropagationTargets:b})}},{key:"onTransactionStart",value:function(t){var n,o;(0,r(d[8]).isNearToNow)(t.startTimestamp)&&(null===(n=this.nativeFramesInstrumentation)||void 0===n||n.onTransactionStart(t),null===(o=this.stallTrackingInstrumentation)||void 0===o||o.onTransactionStart(t))}},{key:"onTransactionFinish",value:function(t,n){var o,s;null===(o=this.nativeFramesInstrumentation)||void 0===o||o.onTransactionFinish(t),null===(s=this.stallTrackingInstrumentation)||void 0===s||s.onTransactionFinish(t,n)}},{key:"onAppStartFinish",value:function(t){this._appStartFinishTimestamp=t}},{key:"startUserInteractionTransaction",value:function(t){var n,o,s=this,c=t.elementId,l=t.op;if(this.options.enableUserInteractionTracing)if(this.options.routingInstrumentation)if(c)if(this._currentRoute){var u=(null===(n=this._getCurrentHub)||void 0===n?void 0:n.call(this))||(0,r(d[9]).getCurrentHub)(),p=(0,r(d[9]).getActiveTransaction)(u),T=(null==p?void 0:p.spanId)!==(null===(o=this._inflightInteractionTransaction)||void 0===o?void 0:o.spanId);if(!p||!T){var h=this.options,v=h.idleTimeoutMs,f=h.finalTimeoutMs;this._inflightInteractionTransaction&&(this._inflightInteractionTransaction.cancelIdleTimeout(void 0,{restartOnChildSpanChange:!1}),this._inflightInteractionTransaction=void 0);var _=`${this._currentRoute}.${c}`,S={name:_,op:l,trimEnd:!0};return this._inflightInteractionTransaction=(0,r(d[9]).startIdleTransaction)(u,S,v,f,!0),this._inflightInteractionTransaction.registerBeforeFinishCallback((function(t){s._inflightInteractionTransaction=void 0,s.onTransactionFinish(t)})),this._inflightInteractionTransaction.registerBeforeFinishCallback(r(d[10]).onlySampleIfChildSpans),this.onTransactionStart(this._inflightInteractionTransaction),r(d[7]).logger.log(`[ReactNativeTracing] User Interaction Tracing Created ${l} transaction ${_}.`),this._inflightInteractionTransaction}r(d[7]).logger.warn(`[ReactNativeTracing] Did not create ${l} transaction because active transaction ${p.name} exists on the scope.`)}else r(d[7]).logger.log('[ReactNativeTracing] User Interaction Tracing can not create transaction without a current route.');else r(d[7]).logger.log('[ReactNativeTracing] User Interaction Tracing can not create transaction with undefined elementId.');else r(d[7]).logger.error('[ReactNativeTracing] User Interaction Tracing is not working because no routing instrumentation is set.');else r(d[7]).logger.log('[ReactNativeTracing] User Interaction Tracing is disabled.')}},{key:"_instrumentAppStart",value:function(){return(0,r(d[11]).__awaiter)(this,void 0,void 0,(function*(){if(this.options.enableAppStartTracking&&r(d[4]).NATIVE.enableNative){var t=yield r(d[4]).NATIVE.fetchNativeAppStart();if(t&&!t.didFetchAppStart)if(this.useAppStartWithProfiler||(this._appStartFinishTimestamp=(0,r(d[8]).getTimeOriginMilliseconds)()/1e3),this.options.routingInstrumentation)this._awaitingAppStartData=t;else{var n=t.appStartTime/1e3,o=this._createRouteTransaction({name:'App Start',op:r(d[12]).UI_LOAD,startTimestamp:n});o&&this._addAppStartData(o,t)}}}))}},{key:"_addAppStartData",value:function(t,n){if(this._appStartFinishTimestamp){var o=n.appStartTime/1e3,c=n.isColdStart?r(d[12]).APP_START_COLD:r(d[12]).APP_START_WARM;t.startChild({description:n.isColdStart?'Cold App Start':'Warm App Start',op:c,startTimestamp:o,endTimestamp:this._appStartFinishTimestamp});var l=1e3*this._appStartFinishTimestamp-n.appStartTime;if(!(l>=s._maxAppStart)){var u=n.isColdStart?r(d[13]).APP_START_COLD:r(d[13]).APP_START_WARM;t.setMeasurement(u,l,'millisecond')}}else r(d[7]).logger.warn('App start was never finished.')}},{key:"_onRouteWillChange",value:function(t){return this._createRouteTransaction(t)}},{key:"_onConfirmRoute",value:function(t){var n,o,s;this._currentRoute=null===(o=null===(n=t.data)||void 0===n?void 0:n.route)||void 0===o?void 0:o.name,null===(s=this._getCurrentHub)||void 0===s||s.call(this).configureScope((function(n){var o;if(t.data){var s=t.data;n.addBreadcrumb({category:'navigation',type:'navigation',message:`Navigation to ${t.name}`,data:{from:null===(o=s.previousRoute)||void 0===o?void 0:o.name,to:s.route.name}})}n.setTag('routing.route.name',t.name)}))}},{key:"_createRouteTransaction",value:function(t){var n=this;if(this._getCurrentHub){this._inflightInteractionTransaction&&(r(d[7]).logger.log(`[ReactNativeTracing] Canceling ${this._inflightInteractionTransaction.op} transaction because navigation ${t.op}.`),this._inflightInteractionTransaction.setStatus('cancelled'),this._inflightInteractionTransaction.finish());var o=this.options,s=o.idleTimeoutMs,c=o.finalTimeoutMs,l=Object.assign(Object.assign({},t),{trimEnd:!0}),u=this._getCurrentHub(),p=(0,r(d[9]).startIdleTransaction)(u,l,s,c,!0);return this.onTransactionStart(p),r(d[7]).logger.log(`[ReactNativeTracing] Starting ${t.op} transaction "${t.name}" on scope`),p.registerBeforeFinishCallback((function(t,o){n.onTransactionFinish(t,o)})),p.registerBeforeFinishCallback((function(t){n.options.enableAppStartTracking&&n._awaitingAppStartData&&(t.startTimestamp=n._awaitingAppStartData.appStartTime/1e3,t.op='ui.load',n._addAppStartData(t,n._awaitingAppStartData),n._awaitingAppStartData=void 0)})),p.registerBeforeFinishCallback((function(t,n){(0,r(d[8]).adjustTransactionDuration)(c,t,n)})),this.options.ignoreEmptyBackNavigationTransactions&&p.registerBeforeFinishCallback((function(t){var n,o;!(null===(o=null===(n=t.data)||void 0===n?void 0:n.route)||void 0===o?void 0:o.hasBeenSeen)||t.spanRecorder&&0!==t.spanRecorder.spans.filter((function(n){return n.spanId!==t.spanId})).length||(r(d[7]).logger.log('[ReactNativeTracing] Not sampling transaction as route has been seen before. Pass ignoreEmptyBackNavigationTransactions = false to disable this feature.'),t.sampled=!1)})),p}r(d[7]).logger.warn(`[ReactNativeTracing] Did not create ${t.op} transaction because _getCurrentHub is invalid.`)}}]),s})();e.ReactNativeTracing=s,s.id='ReactNativeTracing',s._maxAppStart=6e4}),619,[598,451,452,424,603,620,621,426,615,483,623,602,624,622]);