__d((function(g,r,i,a,m,_e,d){Object.defineProperty(_e,'__esModule',{value:!0});var e="Not capturing exception because it's already been captured.",n=(function(){"use strict";function n(e){if(r(d[0])(this,n),this._options=e,this._integrations={},this._integrationsInitialized=!1,this._numProcessing=0,this._outcomes={},this._hooks={},e.dsn?this._dsn=r(d[1]).makeDsn(e.dsn):('undefined'==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&r(d[1]).logger.warn('No DSN provided, client will not do anything.'),this._dsn){var t=r(d[2]).getEnvelopeEndpointWithUrlEncodedAuth(this._dsn,e);this._transport=e.transport(Object.assign({recordDroppedEvent:this.recordDroppedEvent.bind(this)},e.transportOptions,{url:t}))}}return r(d[3])(n,[{key:"captureException",value:function(n,t,o){var s=this;if(!r(d[1]).checkOrSetAlreadyCaught(n)){var u=t&&t.event_id;return this._process(this.eventFromException(n,t).then((function(e){return s._captureEvent(e,t,o)})).then((function(e){u=e}))),u}('undefined'==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&r(d[1]).logger.log(e)}},{key:"captureMessage",value:function(e,n,t,o){var s=this,u=t&&t.event_id,_=r(d[1]).isPrimitive(e)?this.eventFromMessage(String(e),n,t):this.eventFromException(e,t);return this._process(_.then((function(e){return s._captureEvent(e,t,o)})).then((function(e){u=e}))),u}},{key:"captureEvent",value:function(n,t,o){if(!(t&&t.originalException&&r(d[1]).checkOrSetAlreadyCaught(t.originalException))){var s=t&&t.event_id;return this._process(this._captureEvent(n,t,o).then((function(e){s=e}))),s}('undefined'==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&r(d[1]).logger.log(e)}},{key:"captureSession",value:function(e){this._isEnabled()?'string'!=typeof e.release?('undefined'==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&r(d[1]).logger.warn('Discarded session because of missing or non-string release'):(this.sendSession(e),r(d[4]).updateSession(e,{init:!1})):('undefined'==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&r(d[1]).logger.warn('SDK not enabled, will not capture session.')}},{key:"getDsn",value:function(){return this._dsn}},{key:"getOptions",value:function(){return this._options}},{key:"getSdkMetadata",value:function(){return this._options._metadata}},{key:"getTransport",value:function(){return this._transport}},{key:"flush",value:function(e){var n=this._transport;return n?this._isClientDoneProcessing(e).then((function(t){return n.flush(e).then((function(e){return t&&e}))})):r(d[1]).resolvedSyncPromise(!0)}},{key:"close",value:function(e){var n=this;return this.flush(e).then((function(e){return n.getOptions().enabled=!1,e}))}},{key:"setupIntegrations",value:function(){this._isEnabled()&&!this._integrationsInitialized&&(this._integrations=r(d[5]).setupIntegrations(this._options.integrations),this._integrationsInitialized=!0)}},{key:"getIntegrationById",value:function(e){return this._integrations[e]}},{key:"getIntegration",value:function(e){try{return this._integrations[e.id]||null}catch(n){return('undefined'==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&r(d[1]).logger.warn(`Cannot retrieve integration ${e.id} from the current Client`),null}}},{key:"addIntegration",value:function(e){r(d[5]).setupIntegration(e,this._integrations)}},{key:"sendEvent",value:function(e){var n=this,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._dsn){var o=r(d[6]).createEventEnvelope(e,this._dsn,this._options._metadata,this._options.tunnel);for(var s of t.attachments||[])o=r(d[1]).addItemToEnvelope(o,r(d[1]).createAttachmentEnvelopeItem(s,this._options.transportOptions&&this._options.transportOptions.textEncoder));var u=this._sendEnvelope(o);u&&u.then((function(t){return n.emit('afterSendEvent',e,t)}),null)}}},{key:"sendSession",value:function(e){if(this._dsn){var n=r(d[6]).createSessionEnvelope(e,this._dsn,this._options._metadata,this._options.tunnel);this._sendEnvelope(n)}}},{key:"recordDroppedEvent",value:function(e,n,t){if(this._options.sendClientReports){var o=`${e}:${n}`;('undefined'==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&r(d[1]).logger.log(`Adding outcome: "${o}"`),this._outcomes[o]=this._outcomes[o]+1||1}}},{key:"on",value:function(e,n){this._hooks[e]||(this._hooks[e]=[]),this._hooks[e].push(n)}},{key:"emit",value:function(e){for(var n=arguments.length,t=new Array(n>1?n-1:0),o=1;o<n;o++)t[o-1]=arguments[o];this._hooks[e]&&this._hooks[e].forEach((function(e){return e.apply(void 0,t)}))}},{key:"_updateSessionFromEvent",value:function(e,n){var t=!1,o=!1,s=n.exception&&n.exception.values;if(s)for(var u of(o=!0,s)){var _=u.mechanism;if(_&&!1===_.handled){t=!0;break}}var c='ok'===e.status;(c&&0===e.errors||c&&t)&&(r(d[4]).updateSession(e,Object.assign({},t&&{status:'crashed'},{errors:e.errors||Number(o||t)})),this.captureSession(e))}},{key:"_isClientDoneProcessing",value:function(e){var n=this;return new(r(d[1]).SyncPromise)((function(t){var o=0,s=setInterval((function(){0==n._numProcessing?(clearInterval(s),t(!0)):(o+=1,e&&o>=e&&(clearInterval(s),t(!1)))}),1)}))}},{key:"_isEnabled",value:function(){return!1!==this.getOptions().enabled&&void 0!==this._dsn}},{key:"_prepareEvent",value:function(e,n,t){var o=this,s=this.getOptions(),u=Object.keys(this._integrations);return!n.integrations&&u.length>0&&(n.integrations=u),r(d[7]).prepareEvent(s,e,n,t).then((function(e){if(null===e)return e;var n=(e.sdkProcessingMetadata||{}).propagationContext;if(!(e.contexts&&e.contexts.trace)&&n){var s=n.traceId,u=n.spanId,_=n.parentSpanId,c=n.dsc;e.contexts=Object.assign({trace:{trace_id:s,span_id:u,parent_span_id:_}},e.contexts);var l=c||r(d[8]).getDynamicSamplingContextFromClient(s,o,t);e.sdkProcessingMetadata=Object.assign({dynamicSamplingContext:l},e.sdkProcessingMetadata)}return e}))}},{key:"_captureEvent",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=arguments.length>2?arguments[2]:void 0;return this._processEvent(e,n,t).then((function(e){return e.event_id}),(function(e){if('undefined'==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__){var n=e;'log'===n.logLevel?r(d[1]).logger.log(n.message):r(d[1]).logger.warn(n)}}))}},{key:"_processEvent",value:function(e,n,_){var c=this,l=this.getOptions(),h=l.sampleRate;if(!this._isEnabled())return r(d[1]).rejectedSyncPromise(new(r(d[1]).SentryError)('SDK not enabled, will not capture event.','log'));var p=u(e),v=s(e),f=e.type||'error',E=`before send for type \`${f}\``;if(v&&'number'==typeof h&&Math.random()>h)return this.recordDroppedEvent('sample_rate','error',e),r(d[1]).rejectedSyncPromise(new(r(d[1]).SentryError)(`Discarding event because it's not included in the random sample (sampling rate = ${h})`,'log'));var y='replay_event'===f?'replay':f;return this._prepareEvent(e,n,_).then((function(s){if(null===s)throw c.recordDroppedEvent('event_processor',y,e),new(r(d[1]).SentryError)('An event processor returned `null`, will not send event.','log');return n.data&&!0===n.data.__sentry__?s:t(o(l,s,n),E)})).then((function(t){if(null===t)throw c.recordDroppedEvent('before_send',y,e),new(r(d[1]).SentryError)(`${E} returned \`null\`, will not send event.`,'log');var o=_&&_.getSession();!p&&o&&c._updateSessionFromEvent(o,t);var s=t.transaction_info;if(p&&s&&t.transaction!==e.transaction){t.transaction_info=Object.assign({},s,{source:'custom'})}return c.sendEvent(t,n),t})).then(null,(function(e){if(e instanceof r(d[1]).SentryError)throw e;throw c.captureException(e,{data:{__sentry__:!0},originalException:e}),new(r(d[1]).SentryError)(`Event processing pipeline threw an error, original event will not be sent. Details have been sent as a new event.\nReason: ${e}`)}))}},{key:"_process",value:function(e){var n=this;this._numProcessing++,e.then((function(e){return n._numProcessing--,e}),(function(e){return n._numProcessing--,e}))}},{key:"_sendEnvelope",value:function(e){if(this._transport&&this._dsn)return this.emit('beforeEnvelope',e),this._transport.send(e).then(null,(function(e){('undefined'==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&r(d[1]).logger.error('Error while sending event:',e)}));('undefined'==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&r(d[1]).logger.error('Transport disabled')}},{key:"_clearOutcomes",value:function(){var e=this._outcomes;return this._outcomes={},Object.keys(e).map((function(n){var t=n.split(':'),o=r(d[9])(t,2);return{reason:o[0],category:o[1],quantity:e[n]}}))}}]),n})();function t(e,n){var t=`${n} must return \`null\` or a valid event.`;if(r(d[1]).isThenable(e))return e.then((function(e){if(!r(d[1]).isPlainObject(e)&&null!==e)throw new(r(d[1]).SentryError)(t);return e}),(function(e){throw new(r(d[1]).SentryError)(`${n} rejected with ${e}`)}));if(!r(d[1]).isPlainObject(e)&&null!==e)throw new(r(d[1]).SentryError)(t);return e}function o(e,n,t){var o=e.beforeSend,_=e.beforeSendTransaction;return s(n)&&o?o(n,t):u(n)&&_?_(n,t):n}function s(e){return void 0===e.type}function u(e){return'transaction'===e.type}_e.BaseClient=n}),505,[451,426,504,452,488,506,507,508,495,439]);