__d((function(g,r,i,a,m,_e,d){Object.defineProperty(_e,"__esModule",{value:!0}),_e.ReactNavigationV4Instrumentation=_e.INITIAL_TRANSACTION_CONTEXT_V4=void 0;var t=r(d[0])(r(d[1])),e=r(d[0])(r(d[2])),n=r(d[0])(r(d[3])),o=r(d[0])(r(d[4])),s=r(d[0])(r(d[5])),u=r(d[0])(r(d[6]));function c(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}var l={routeChangeTimeoutMs:1e3},_=(function(_){(0,o.default)(R,_);var v,p,f=(v=R,p=c(),function(){var t,e=(0,u.default)(v);if(p){var n=(0,u.default)(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return(0,s.default)(this,t)});function R(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,t.default)(this,R),(e=f.call(this)).name=R.instrumentationName,e._appContainer=null,e._maxRecentRouteLen=200,e._recentRouteKeys=[],e._initialStateHandled=!1,e._pushRecentRouteKey=function(t){e._recentRouteKeys.push(t),e._recentRouteKeys.length>e._maxRecentRouteLen&&(e._recentRouteKeys=e._recentRouteKeys.slice(e._recentRouteKeys.length-e._maxRecentRouteLen))},e._onBeforeNavigateNotSampled=function(t){r(d[7]).logger.log(`[ReactNavigationV4Instrumentation] Will not send transaction "${t}" due to beforeNavigate.`)},e._options=Object.assign(Object.assign({},l),n),e}return(0,e.default)(R,[{key:"registerRoutingInstrumentation",value:function(t,e,o){(0,n.default)((0,u.default)(R.prototype),"registerRoutingInstrumentation",this).call(this,t,e,o),this._initialStateHandled||(this._latestTransaction=this.onRouteWillChange(h),this._appContainer?(this._updateLatestTransaction(),this._initialStateHandled=!0):this._stateChangeTimeout=setTimeout(this._discardLatestTransaction.bind(this),this._options.routeChangeTimeoutMs))}},{key:"registerAppContainer",value:function(t){r(d[8]).RN_GLOBAL_OBJ.__sentry_rn_v4_registered||(this._appContainer='current'in t?t.current:t,this._appContainer?(this._patchRouter(),this._initialStateHandled||(this._latestTransaction?this._updateLatestTransaction():r(d[7]).logger.log('[ReactNavigationV4Instrumentation] App container registered, but integration has not been setup yet.'),this._initialStateHandled=!0),r(d[8]).RN_GLOBAL_OBJ.__sentry_rn_v4_registered=!0):r(d[7]).logger.warn('[ReactNavigationV4Instrumentation] Received invalid app container ref!'))}},{key:"_updateLatestTransaction",value:function(){if(this._appContainer&&this._latestTransaction){var t=this._appContainer._navigation.state;void 0!==this._stateChangeTimeout&&(clearTimeout(this._stateChangeTimeout),this._stateChangeTimeout=void 0),this._onStateChange(t,!0)}}},{key:"_patchRouter",value:function(){var t=this;if(this._appContainer){var e=this._appContainer._navigation.router.getStateForAction;this._appContainer._navigation.router.getStateForAction=function(n,o){var s=e(n,o);return t._onStateChange(s),s}}}},{key:"_onStateChange",value:function(t){var e,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t&&void 0!==t){var o=this._getCurrentRouteFromState(t);if(!this._prevRoute||o.key!==this._prevRoute.key){var s=this._getTransactionContext(o,this._prevRoute),u=s;n&&this._latestTransaction&&(u=Object.assign(Object.assign({},this._latestTransaction.toContext()),s));var c=this._prepareFinalContext(u);if(n&&this._latestTransaction){this._latestTransaction.updateWithContext(c);var l=u.name!==c.name;this._latestTransaction.setName(c.name,l?r(d[9]).customTransactionSource:r(d[9]).defaultTransactionSource)}else this._latestTransaction=this.onRouteWillChange(c);null===(e=this._onConfirmRoute)||void 0===e||e.call(this,c),this._pushRecentRouteKey(o.key),this._prevRoute=o}}else r(d[7]).logger.warn('[ReactNavigationV4Instrumentation] onStateChange called without a valid state.')}},{key:"_prepareFinalContext",value:function(t){var e,n=null===(e=this._beforeNavigate)||void 0===e?void 0:e.call(this,Object.assign({},t));return n||(r(d[7]).logger.error(`[ReactNavigationV4Instrumentation] beforeNavigate returned ${n}, return context.sampled = false to not send transaction.`),n=Object.assign(Object.assign({},t),{sampled:!1})),!1===n.sampled&&this._onBeforeNavigateNotSampled(n.name),n}},{key:"_getTransactionContext",value:function(t,e){var n,o,s={route:{name:t.routeName,key:t.key,params:null!==(n=t.params)&&void 0!==n?n:{},hasBeenSeen:this._recentRouteKeys.includes(t.key)},previousRoute:e?{name:e.routeName,key:e.key,params:null!==(o=e.params)&&void 0!==o?o:{}}:null};return{name:t.routeName,op:'navigation',tags:{'routing.instrumentation':R.instrumentationName,'routing.route.name':t.routeName},data:s}}},{key:"_getCurrentRouteFromState",value:function(t){var e=t.routes[t.index];return'index'in e&&'routes'in e&&'number'==typeof e.index&&Array.isArray(e.routes)?this._getCurrentRouteFromState(e):e}},{key:"_discardLatestTransaction",value:function(){this._latestTransaction&&(this._latestTransaction.sampled=!1,this._latestTransaction.finish(),this._latestTransaction=void 0)}}]),R})(r(d[10]).InternalRoutingInstrumentation);_e.ReactNavigationV4Instrumentation=_,_.instrumentationName='react-navigation-v4';var h={name:'App Launch',op:'navigation',tags:{'routing.instrumentation':_.instrumentationName},data:{},metadata:{source:'view'}};_e.INITIAL_TRANSACTION_CONTEXT_V4=h}),626,[598,451,452,493,449,446,445,426,605,615,616]);